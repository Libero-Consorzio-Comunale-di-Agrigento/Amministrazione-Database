<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.9.xsd">
    <property name="modulo" value="AD4"/>
    <property name="descModulo" value="Amministratore DataBase"/>
    <property name="progetto" value="AD4"/>
    <changeSet id="201903121340" author="mturra" runOnChange="true">
        <preConditions onFailMessage="Modulo preesistente '${modulo}" onFail="CONTINUE">
            <sqlCheck expectedResult="0">
                select count(1) from moduli where modulo = '${modulo}';
            </sqlCheck>
        </preConditions>
        <comment>Inserimento del modulo AD4</comment>
        <sql>alter table moduli disable all triggers</sql>
        <sql dbms="oracle"
             endDelimiter=";"
             splitStatements="true"
             stripComments="true">
            Insert into MODULI
            (MODULO, DESCRIZIONE, PROGETTO)
            Values
            ('${modulo}', '${descModulo}', '${progetto}');
            Insert into MODULI
            (MODULO, DESCRIZIONE, PROGETTO)
            Values
            ('MODULDAP', 'Modulo generico per accesso LDAP', 'PROGLDAP');
            Insert into MODULI
            (MODULO, DESCRIZIONE, PROGETTO)
            Values
            ('AD4WEB', 'Modulo AD4WEB', 'AD4')
        </sql>
        <sql>alter table moduli enable all triggers</sql>
        <rollback>
            <sql>alter table moduli enable all triggers</sql>
        </rollback>
    </changeSet>
</databaseChangeLog>